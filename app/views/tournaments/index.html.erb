<h1>Listing Tournaments</h1>

<div id="tournament-list">
	<% if @tournaments.length > 0 %>
		<%# Each tournament has a div for its listing %>
		<% @tournaments.each do |t| %>
			<div class="row tournament-listing">
				<div class="col-md-2 "><%= image_tag 'http://www.gravatar.com/avatar/' + Digest::MD5.hexdigest(t.hosts.first.email) + '?s=100&d=mm' %></div>
				<div class="col-md-8">
					<%# "header" %>
					<%= link_to(t) do %><h3><%= t.name %></h3><% end %>
					<div class="row" style="margin-left:2%;">
						<div class="col-md-4 host">
							Hosted by: <%= t.hosts.first.name %>
						</div>
						<div class="col-md-4 things">
						  <p> Players per team: <%= t.min_players_per_team %></p>
						  <p> Players signed up: <%= t.players.count %> </p>
						</div>
						<div class="col-md-4 things">
						  <p> <%= (t.randomized_teams)? "Teams are Random" : "Teams are Chosen" %></p>
						  <p> Players signed up: <%= t.players.count %> </p>
						</div>
					</div>
				</div>
				<div class="col-md-2">
					<% if signed_in? %>
						<% if !t.players.include?(current_user) %>
							<%= form_tag(tournament_path(t), method: "put") do %>
								<input type="hidden" name="update_action" value="join">
								<%= submit_tag("Join")
								%>
							<% end %>
						<% else %>
							<p style="margin-top:10px;"> You've signed up for this tournament! </p>
						<% end %>
					<% end %>
				</div>
			</div>
		<% end %>
	<% else %>
		<p class="no-entries"> No tournaments going on right now...
			<% if current_user.can?(:create_tournament) %>
				Why not start your own?
			<% end %>
		</p>
	<% end %>
</div>

<% if current_user.can?(:create_tournament) %>
	<div><%= link_to 'New Tournament',  new_tournament_path, :class => "btn btn-warning btn-lg" %></div>
<% end %>
